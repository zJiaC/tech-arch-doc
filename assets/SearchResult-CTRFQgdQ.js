import{u as U,g as te,h as se,i as Y,j as ae,P as le,t as re,k as oe,l as b,m as w,n as ie,p as z,q as s,s as ue,R as T,v as ne,x as ce,y as pe,C as de,z as ve,A as ge,B as he,D as me,E as ye,F as Ee,G as fe,H as O,I as $,J as Be,K as H,L as ke}from"./app-CUJPFFrd.js";const qe=["/","/home.html","/posts/english/That's%20Why%20(You%20Go%20Away).html","/posts/interview/","/posts/knowledge-reserve/","/posts/knowledge-reserve/collect-note.html","/posts/knowledge-reserve/emoji.html","/posts/knowledge-reserve/microservices.html","/posts/ops/","/posts/ops/deploy.html","/posts/ops/fio.html","/posts/ops/github-actions.html","/posts/ops/linux.html","/posts/ops/wsl2.html","/posts/question/","/posts/question/article-1.html","/posts/question/article-3.html","/posts/question/article-4.html","/posts/question/article-5.html","/posts/question/article-8.html","/posts/question/gitalk.html","/posts/question/nginx.html","/posts/question/prometheus.html","/posts/coding-related/datasource/alter-column.html","/posts/coding-related/datasource/mysql.html","/posts/coding-related/datasource/redis.html","/posts/coding-related/datasource/tls10.html","/posts/coding-related/java/design_patterns.html","/posts/coding-related/java/juc.html","/posts/coding-related/java/jvm.html","/posts/coding-related/java/note_first.html","/posts/coding-related/java/prometheus.html","/posts/coding-related/java/type.html","/posts/coding-related/rust/rust_course_01.html","/posts/coding-related/rust/rust_course_02.html","/posts/coding-related/spring/spring.html","/posts/coding-related/typescript/electron-base.html","/posts/knowledge-reserve/redis/redis-base.html","/404.html","/posts/english/","/posts/","/posts/coding-related/datasource/","/posts/coding-related/","/posts/coding-related/java/","/posts/coding-related/rust/","/posts/coding-related/spring/","/posts/coding-related/typescript/","/posts/knowledge-reserve/redis/","/category/","/category/english/","/category/%E9%9D%A2%E8%AF%95/","/category/%E6%94%B6%E8%97%8F/","/category/%E8%BF%90%E7%BB%B4/","/category/%E7%BC%96%E7%A8%8B/","/category/%E9%97%AE%E9%A2%98/","/category/%E7%9B%91%E6%8E%A7/","/tag/","/tag/java/","/tag/spring/","/tag/redis/","/tag/mq/","/tag/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/","/tag/mysql/","/tag/%E5%88%86%E5%B8%83%E5%BC%8F/","/tag/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/","/tag/%E8%BD%AF%E4%BB%B6/","/tag/%E6%94%B6%E8%97%8F%E7%BD%91%E5%9D%80/","/tag/docker/","/tag/fio/","/tag/io/","/tag/github/","/tag/linux/","/tag/vim/","/tag/wsl2/","/tag/spring-boot/","/tag/quartz/","/tag/druid/","/tag/gitalk/","/tag/nginx/","/tag/prometheus/","/tag/fastjson/","/tag/%E6%95%B0%E6%8D%AE%E5%BA%93/","/tag/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","/tag/grafana/","/tag/%E5%8F%8D%E5%B0%84/","/tag/rust/","/tag/electron/","/tag/react/","/tag/typescript/","/tag/antd/","/tag/node/","/article/","/star/","/timeline/"],Ae="SEARCH_PRO_QUERY_HISTORY",y=U(Ae,[]),we=()=>{const{queryHistoryCount:a}=H,l=a>0;return{enabled:l,queryHistory:y,addQueryHistory:r=>{l&&(y.value=Array.from(new Set([r,...y.value.slice(0,a-1)])))},removeQueryHistory:r=>{y.value=[...y.value.slice(0,r),...y.value.slice(r+1)]}}},S=a=>qe[a.id]+("anchor"in a?`#${a.anchor}`:""),He="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:I}=H,E=U(He,[]),Re=()=>{const a=I>0;return{enabled:a,resultHistory:E,addResultHistory:l=>{if(a){const r={link:S(l),display:l.display};"header"in l&&(r.header=l.header),E.value=[r,...E.value.slice(0,I-1)]}},removeResultHistory:l=>{E.value=[...E.value.slice(0,l),...E.value.slice(l+1)]}}},xe=a=>{const l=de(),r=Y(),R=ve(),i=b(0),k=w(()=>i.value>0),g=ge([]);return he(()=>{const{search:h,terminate:x}=me(),f=Be(c=>{const B=c.join(" "),{searchFilter:D=v=>v,splitWord:j,suggestionsFilter:L,...m}=l.value;B?(i.value+=1,h(c.join(" "),r.value,m).then(v=>D(v,B,r.value,R.value)).then(v=>{i.value-=1,g.value=v}).catch(v=>{console.warn(v),i.value-=1,i.value||(g.value=[])})):g.value=[]},H.searchDelay-H.suggestDelay);z([a,r],([c])=>f(c),{immediate:!0}),ye(()=>{x()})}),{isSearching:k,results:g}};var je=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:l}){const r=se(),R=Y(),i=ae(le),{enabled:k,addQueryHistory:g,queryHistory:h,removeQueryHistory:x}=we(),{enabled:f,resultHistory:c,addResultHistory:B,removeResultHistory:D}=Re(),j=k||f,L=re(a,"queries"),{results:m,isSearching:v}=xe(L),o=oe({isQuery:!0,index:0}),p=b(0),d=b(0),_=w(()=>j&&(h.value.length>0||c.value.length>0)),C=w(()=>m.value.length>0),Q=w(()=>m.value[p.value]||null),G=()=>{const{isQuery:e,index:t}=o;t===0?(o.isQuery=!e,o.index=e?c.value.length-1:h.value.length-1):o.index=t-1},M=()=>{const{isQuery:e,index:t}=o;t===(e?h.value.length-1:c.value.length-1)?(o.isQuery=!e,o.index=0):o.index=t+1},J=()=>{p.value=p.value>0?p.value-1:m.value.length-1,d.value=Q.value.contents.length-1},K=()=>{p.value=p.value<m.value.length-1?p.value+1:0,d.value=0},V=()=>{d.value<Q.value.contents.length-1?d.value+=1:K()},W=()=>{d.value>0?d.value-=1:J()},F=e=>e.map(t=>ke(t)?t:s(t[0],t[1])),N=e=>{if(e.type==="customField"){const t=Ee[e.index]||"$content",[u,A=""]=fe(t)?t[R.value].split("$content"):t.split("$content");return e.display.map(n=>s("div",F([u,...n,A])))}return e.display.map(t=>s("div",F(t)))},q=()=>{p.value=0,d.value=0,l("updateQuery",""),l("close")},X=()=>k?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},i.value.queryHistory),h.value.map((e,t)=>s("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===t}],onClick:()=>{l("updateQuery",e)}},[s(O,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},e),s("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:u=>{u.preventDefault(),u.stopPropagation(),x(t)}})]))])):null,Z=()=>f?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},i.value.resultHistory),c.value.map((e,t)=>s(T,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===t}],onClick:()=>{q()}},()=>[s(O,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[e.header?s("div",{class:"content-header"},e.header):null,s("div",e.display.map(u=>F(u)).flat())]),s("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:u=>{u.preventDefault(),u.stopPropagation(),D(t)}})]))])):null;return ie("keydown",e=>{if(a.isFocusing){if(C.value){if(e.key==="ArrowUp")W();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const t=Q.value.contents[d.value];g(a.queries.join(" ")),B(t),r.push(S(t)),q()}}else if(f){if(e.key==="ArrowUp")G();else if(e.key==="ArrowDown")M();else if(e.key==="Enter"){const{index:t}=o;o.isQuery?(l("updateQuery",h.value[t]),e.preventDefault()):(r.push(c.value[t].link),q())}}}}),z([p,d],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>s("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!C.value:!_.value}],id:"search-pro-results"},a.queries.length?v.value?s(ue,{hint:i.value.searching}):C.value?s("ul",{class:"search-pro-result-list"},m.value.map(({title:e,contents:t},u)=>{const A=p.value===u;return s("li",{class:["search-pro-result-list-item",{active:A}]},[s("div",{class:"search-pro-result-title"},e||i.value.defaultTitle),t.map((n,ee)=>{const P=A&&d.value===ee;return s(T,{to:S(n),class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{g(a.queries.join(" ")),B(n),q()}},()=>[n.type==="text"?null:s(n.type==="title"?ne:n.type==="heading"?ce:pe,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?s("div",{class:"content-header"},n.header):null,s("div",N(n))])])})])})):i.value.emptyResult:j?_.value?[X(),Z()]:i.value.emptyHistory:i.value.emptyResult)}});export{je as default};
