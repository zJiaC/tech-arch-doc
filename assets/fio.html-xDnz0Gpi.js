import{_ as a}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as e,f as n}from"./app-XkPbdq-W.js";const r={},p=n(`<h1 id="磁盘-io-测试工具" tabindex="-1"><a class="header-anchor" href="#磁盘-io-测试工具" aria-hidden="true">#</a> 磁盘 IO 测试工具</h1><h2 id="前情提要" tabindex="-1"><a class="header-anchor" href="#前情提要" aria-hidden="true">#</a> 前情提要</h2><blockquote><p>Rancher 部署 ES 发现客户提供的挂载卷比较慢，因而采取 FIO 测试得到读写数据</p></blockquote><h2 id="前期准备" tabindex="-1"><a class="header-anchor" href="#前期准备" aria-hidden="true">#</a> 前期准备</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ubuntu 环境可以直接装,软不存在软件包则执行 apt-get update 更新。</span>
<span class="token function">apt-get</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> fio
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="具体命令" tabindex="-1"><a class="header-anchor" href="#具体命令" aria-hidden="true">#</a> 具体命令</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>顺序读
fio <span class="token parameter variable">-filename</span><span class="token operator">=</span>/usr/share/elasticsearch/data/sda <span class="token parameter variable">-direct</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-iodepth</span> <span class="token number">1</span> <span class="token parameter variable">-thread</span> <span class="token parameter variable">-rw</span><span class="token operator">=</span>read <span class="token parameter variable">-ioengine</span><span class="token operator">=</span>psync <span class="token parameter variable">-bs</span><span class="token operator">=</span>16k <span class="token parameter variable">-size</span><span class="token operator">=</span>200G <span class="token parameter variable">-numjobs</span><span class="token operator">=</span><span class="token number">30</span> <span class="token parameter variable">-runtime</span><span class="token operator">=</span><span class="token number">1000</span> <span class="token parameter variable">-group_reporting</span> <span class="token parameter variable">-name</span><span class="token operator">=</span>mytest
顺序写
fio <span class="token parameter variable">-filename</span><span class="token operator">=</span>/usr/share/elasticsearch/data/sda <span class="token parameter variable">-direct</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-iodepth</span> <span class="token number">1</span> <span class="token parameter variable">-thread</span> <span class="token parameter variable">-rw</span><span class="token operator">=</span>write <span class="token parameter variable">-ioengine</span><span class="token operator">=</span>psync <span class="token parameter variable">-bs</span><span class="token operator">=</span>16k <span class="token parameter variable">-size</span><span class="token operator">=</span>200G <span class="token parameter variable">-numjobs</span><span class="token operator">=</span><span class="token number">30</span> <span class="token parameter variable">-runtime</span><span class="token operator">=</span><span class="token number">1000</span> <span class="token parameter variable">-group_reporting</span> <span class="token parameter variable">-name</span><span class="token operator">=</span>mytest
随机读
fio <span class="token parameter variable">-filename</span><span class="token operator">=</span>/usr/share/elasticsearch/data/sda <span class="token parameter variable">-direct</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-iodepth</span> <span class="token number">1</span> <span class="token parameter variable">-thread</span> <span class="token parameter variable">-rw</span><span class="token operator">=</span>randread <span class="token parameter variable">-ioengine</span><span class="token operator">=</span>psync <span class="token parameter variable">-bs</span><span class="token operator">=</span>16k <span class="token parameter variable">-size</span><span class="token operator">=</span>200G <span class="token parameter variable">-numjobs</span><span class="token operator">=</span><span class="token number">30</span> <span class="token parameter variable">-runtime</span><span class="token operator">=</span><span class="token number">1000</span> <span class="token parameter variable">-group_reporting</span> <span class="token parameter variable">-name</span><span class="token operator">=</span>mytest
随机写
fio <span class="token parameter variable">-filename</span><span class="token operator">=</span>/usr/share/elasticsearch/data/sda <span class="token parameter variable">-direct</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-iodepth</span> <span class="token number">1</span> <span class="token parameter variable">-thread</span> <span class="token parameter variable">-rw</span><span class="token operator">=</span>randwrite <span class="token parameter variable">-ioengine</span><span class="token operator">=</span>psync <span class="token parameter variable">-bs</span><span class="token operator">=</span>16k <span class="token parameter variable">-size</span><span class="token operator">=</span>200G <span class="token parameter variable">-numjobs</span><span class="token operator">=</span><span class="token number">30</span> <span class="token parameter variable">-runtime</span><span class="token operator">=</span><span class="token number">1000</span> <span class="token parameter variable">-group_reporting</span> <span class="token parameter variable">-name</span><span class="token operator">=</span>mytest
混合随机读写
fio <span class="token parameter variable">-filename</span><span class="token operator">=</span>/usr/share/elasticsearch/data/sda <span class="token parameter variable">-direct</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-iodepth</span> <span class="token number">1</span> <span class="token parameter variable">-thread</span> <span class="token parameter variable">-rw</span><span class="token operator">=</span>randrw <span class="token parameter variable">-rwmixread</span><span class="token operator">=</span><span class="token number">70</span> <span class="token parameter variable">-ioengine</span><span class="token operator">=</span>psync <span class="token parameter variable">-bs</span><span class="token operator">=</span>16k <span class="token parameter variable">-size</span><span class="token operator">=</span>200G <span class="token parameter variable">-numjobs</span><span class="token operator">=</span><span class="token number">30</span> <span class="token parameter variable">-runtime</span><span class="token operator">=</span><span class="token number">100</span> <span class="token parameter variable">-group_reporting</span> <span class="token parameter variable">-name</span><span class="token operator">=</span>mytest <span class="token parameter variable">-ioscheduler</span><span class="token operator">=</span>noop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="说明" tabindex="-1"><a class="header-anchor" href="#说明" aria-hidden="true">#</a> 说明</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>filename=/dev/sdb1       测试文件名称，通常选择需要测试的盘的data目录。
direct=1                 测试过程绕过机器自带的buffer。使测试结果更真实。
rw=randwrite             测试随机写的I/O
rw=randrw                测试随机写和读的I/O
bs=16k                   单次io的块文件大小为16k
bsrange=512-2048         同上，提定数据块的大小范围
size=5g                  本次的测试文件大小为5g，以每次4k的io进行测试。
numjobs=30               本次的测试线程为30.
runtime=1000             测试时间为1000秒，如果不写则一直将5g文件分4k每次写完为止。
ioengine=psync           io引擎使用pync方式
rwmixwrite=30            在混合读写的模式下，写占30%
group_reporting          关于显示结果的，汇总每个进程的信息。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9),t=[p];function o(l,i){return s(),e("div",null,t)}const d=a(r,[["render",o],["__file","fio.html.vue"]]);export{d as default};
