import{u as B,g as G,p as J,q as E,t as K,v as O,x as V,h as w,j as k,y as W,z as P,m as t,R as A,A as N,B as T,C as X,D as Y,E as Z,F as _,s as ee,G as te,L as ae,H as se,I as le,J as ue,K as q,M as re}from"./app-91dd5080.js";const ne="search-pro-result-history",c=B(ne,[]),ce=()=>{const{resultHistoryCount:u}=q,o=u>0;return{enabled:o,resultHistory:c,addResultHistory:l=>{o&&(c.value.length<u?c.value=[l,...c.value]:c.value=[l,...c.value.slice(0,u-1)])},removeResultHistory:l=>{c.value=[...c.value.slice(0,l),...c.value.slice(l+1)]}}},oe=u=>{const o=E(),l=w(!1),h=ee([]);let i;const v=ue(d=>{l.value=!0,i==null||i.terminate(),d?(i=new Worker(`/tech-arch-doc/${q.worker}`,{}),i.addEventListener("message",({data:g})=>{h.value=g,l.value=!1}),i.postMessage({query:d,routeLocale:o.value})):(h.value=[],l.value=!1)},q.delay);return P([u,o],()=>v(u.value),{immediate:!0}),{searching:l,results:h}};var ve=G({name:"SearchResult",props:{query:{type:String,required:!0}},emits:["close","updateQuery"],setup(u,{emit:o}){const l=te(),h=J(),i=E(),v=K(O),{addQueryHistory:d}=ae(),{enabled:g,resultHistory:L,addResultHistory:C,removeResultHistory:Q}=ce(),R=V(u,"query"),{results:y,searching:j}=oe(R),r=w(0),s=w(0),D=k(()=>L.value.length>0),f=k(()=>y.value.length>0),$=k(()=>y.value[r.value]||null),F=()=>{r.value=r.value>0?r.value-1:y.value.length-1,s.value=$.value.contents.length-1},I=()=>{r.value=r.value<y.value.length-1?r.value+1:0,s.value=0},M=()=>{s.value<$.value.contents.length-1?s.value=s.value+1:I()},U=()=>{s.value>0?s.value=s.value-1:F()},b=e=>e.map(a=>re(a)?a:t(a[0],a[1])),S=e=>{if(e.type==="custom"){const a=se[e.index]||"$content",[p,m=""]=le(a)?a[i.value].split("$content"):a.split("$content");return b([p,...e.display,m])}return b(e.display)},H=()=>{r.value=0,s.value=0,o("updateQuery",""),o("close")};return W("keydown",e=>{if(f.value){if(e.key==="ArrowUp")U();else if(e.key==="ArrowDown")M();else if(e.key==="Enter"){const a=$.value.contents[s.value];l.value.path!==a.path&&(d(u.query),C(a),h.push(a.path),H())}}}),P([r,s],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result",{empty:R.value?!f.value:!D.value}],id:"search-pro-results"},R.value===""?D.value?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},v.value.history),L.value.map((e,a)=>t(A,{to:e.path,class:["search-pro-result-item",{active:s.value===a}],onClick:()=>{H()}},()=>[t(N,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.type==="content"&&e.header?t("div",{class:"content-header"},e.header):null,t("div",S(e))]),t("button",{class:"search-pro-close-icon",onClick:p=>{p.preventDefault(),p.stopPropagation(),Q(a)}},t(T))]))])):g?v.value.emptyHistory:v.value.emptyResult:j.value?t(X,{hint:v.value.searching}):f.value?t("ul",{class:"search-pro-result-list"},y.value.map(({title:e,contents:a},p)=>{const m=r.value===p;return t("li",{class:["search-pro-result-list-item",{active:m}]},[t("div",{class:"search-pro-result-title"},e||"Documentation"),a.map((n,z)=>{const x=m&&s.value===z;return t(A,{to:n.path,class:["search-pro-result-item",{active:x,"aria-selected":x}],onClick:()=>{d(u.query),C(n),H()}},()=>[n.type==="content"?null:t(n.type==="title"?Y:n.type==="heading"?Z:_,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[n.type==="content"&&n.header?t("div",{class:"content-header"},n.header):null,t("div",S(n))])])})])})):v.value.emptyResult)}});export{ve as default};
