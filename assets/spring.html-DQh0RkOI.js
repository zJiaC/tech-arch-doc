import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as p,c as l,f as c,b as n,e as a,a as t,d as s}from"./app-CUJPFFrd.js";const r={},u=n("h1",{id:"spring-知识查缺补漏",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#spring-知识查缺补漏"},[n("span",null,"Spring 知识查缺补漏")])],-1),d=s('<h2 id="ioc" tabindex="-1"><a class="header-anchor" href="#ioc"><span>IOC</span></a></h2><ul><li><p>Inversion of Control（“控制反转”）<br><img src="https://image.itbaima.cn/markdown/2022/11/22/sjLiFokU1f3CvH5.png" alt=""></p></li><li><p>作用域</p><ul><li>singleton</li><li>prototype</li></ul></li><li><p>依赖注入</p><ul><li>Setter依赖注入：通过成员属性对应的set方法完成注入。</li><li>构造方法依赖注入：通过构造方法完成注入。</li><li>自动装配</li></ul></li><li><p>生命周期与继承</p><ul><li>如果Bean不是单例模式，而是采用的原型模式，那么就只会在获取时才创建，并调用init-method，而对应的销毁方法不会被调用（因此，对于原型模式下的Bean，Spring无法顾及其完整生命周期，而在单例模式下，Spring能够从Bean对象的创建一直管理到对象的销毁）</li><li>Bean之间也是具备继承关系的，只不过这里的继承并不是类的继承，而是属性的继承</li></ul></li><li><p>工厂Bean</p><ul><li>Mybatis 使用工厂 Bean 管理自己扫描的 Bean</li></ul></li><li><p>注解</p><ul><li>@Resource默认ByName如果找不到则ByType，可以添加到set方法、字段上。</li><li>@Autowired默认是byType，只会根据类型寻找，可以添加在构造方法、set方法、字段、方法参数上。</li></ul></li></ul><p>因为@Resource的匹配机制更加合理高效，因此官方并不推荐使用@Autowired字段注入，当然，实际上Spring官方更推荐我们使用基于构造方法或是Setter的@Autowired注入，比如Setter 注入的一个好处是，Setter 方法使该类的对象能够在以后重新配置或重新注入。其实，最后使用哪个注解，还是看你自己，要是有强迫症不能忍受黄标但是又实在想用字段注入，那就用@Resource注解。</p><h2 id="spring-高级特性" tabindex="-1"><a class="header-anchor" href="#spring-高级特性"><span>Spring 高级特性</span></a></h2>',4),g=n("p",null,"Bean Aware（感知）",-1),m=n("thead",null,[n("tr",null,[n("th",null,"Aware子接口"),n("th",null,"描述")])],-1),k=n("tr",null,[n("td",null,"BeanNameAware"),n("td",null,"获取容器中 Bean 的名称")],-1),b=n("tr",null,[n("td",null,"BeanFactoryAware"),n("td",null,"获取当前 BeanFactory ，这样可以调用容器的服务")],-1),h=n("td",null,"ApplicationContextAware",-1),v={href:"https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FYVl20QqUHTXMubr68wXR1A",target:"_blank",rel:"noopener noreferrer"},f=n("tr",null,[n("td",null,"MessageSourceAware"),n("td",null,"获取 Message Source 相关文本信息")],-1),y=n("tr",null,[n("td",null,"ApplicationEventPublisherAware"),n("td",null,"发布事件")],-1),A=n("tr",null,[n("td",null,"ResourceLoaderAware"),n("td",null,"获取资源加载器，这样获取外部资源文件")],-1),B=s(`<li><p>异步任务</p><ul><li><p>@EnableAsync</p></li><li><p>@Async</p></li><li><p>@Import</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">AspectJAutoProxyRegistrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">EnableAspectJAutoProxy</span> <span class="token punctuation">{</span>
    <span class="token keyword">boolean</span> <span class="token function">proxyTargetClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">boolean</span> <span class="token function">exposeProxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">AspectJAutoProxyRegistrar</span> <span class="token keyword">implements</span> <span class="token class-name">ImportBeanDefinitionRegistrar</span> <span class="token punctuation">{</span>
    <span class="token class-name">AspectJAutoProxyRegistrar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> importingClassMetadata<span class="token punctuation">,</span> <span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      	<span class="token comment">//注册AnnotationAwareAspectJAutoProxyCreator到容器中</span>
        <span class="token class-name">AopConfigUtils</span><span class="token punctuation">.</span><span class="token function">registerAspectJAnnotationAutoProxyCreatorIfNecessary</span><span class="token punctuation">(</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">AnnotationAttributes</span> enableAspectJAutoProxy <span class="token operator">=</span> <span class="token class-name">AnnotationConfigUtils</span><span class="token punctuation">.</span><span class="token function">attributesFor</span><span class="token punctuation">(</span>importingClassMetadata<span class="token punctuation">,</span> <span class="token class-name">EnableAspectJAutoProxy</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>enableAspectJAutoProxy <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>enableAspectJAutoProxy<span class="token punctuation">.</span><span class="token function">getBoolean</span><span class="token punctuation">(</span><span class="token string">&quot;proxyTargetClass&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">AopConfigUtils</span><span class="token punctuation">.</span><span class="token function">forceAutoProxyCreatorToUseClassProxying</span><span class="token punctuation">(</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>enableAspectJAutoProxy<span class="token punctuation">.</span><span class="token function">getBoolean</span><span class="token punctuation">(</span><span class="token string">&quot;exposeProxy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">AopConfigUtils</span><span class="token punctuation">.</span><span class="token function">forceAutoProxyCreatorToExposeProxy</span><span class="token punctuation">(</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>它实现了接口，这个接口也是Spring提供的一种Bean加载机制，它支持直接向容器中添加Bean定义，容器也会加载这个Bean：</li><li>ImportBeanDefinitionRegistrar类只能通过其他类@Import的方式来加载，通常是启动类或配置类。</li><li>使用@Import，如果括号中的类是ImportBeanDefinitionRegistrar的实现类，则会调用接口中方法（一般用于注册Bean）</li><li>实现该接口的类拥有注册bean的能力。</li></ul></li></ul></li><li><p>Spring 事件监听器</p></li>`,2),x=n("h2",{id:"springel-表达式",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#springel-表达式"},[n("span",null,"SpringEL 表达式")])],-1),_={href:"https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#expressions-language-ref",target:"_blank",rel:"noopener noreferrer"},w=s('<h2 id="aop" tabindex="-1"><a class="header-anchor" href="#aop"><span>AOP</span></a></h2><ul><li>通知（Advice）: AOP 框架中的增强处理，通知描述了切面何时执行以及如何执行增强处理，也就是我们上面编写的方法实现。</li><li>连接点（join point）: 连接点表示应用执行过程中能够插入切面的一个点，这个点可以是方法的调用、异常的抛出，实际上就是我们在方法执行前或是执行后需要做的内容。</li><li>切点（PointCut）: 可以插入增强处理的连接点，可以是方法执行之前也可以方法执行之后，还可以是抛出异常之类的。</li><li>切面（Aspect）: 切面是通知和切点的结合，我们之前在xml中定义的就是切面，包括很多信息。</li><li>引入（Introduction）：引入允许我们向现有的类添加新的方法或者属性。</li><li>织入（Weaving）: 将增强处理添加到目标对象中，并创建一个被增强的对象，我们之前都是在将我们的增强处理添加到目标对象，也就是织入（这名字挺有文艺范的）</li></ul><h2 id="事务" tabindex="-1"><a class="header-anchor" href="#事务"><span>事务</span></a></h2><p><img src="https://image.itbaima.cn/markdown/2022/12/17/C1RA4mBEoxNDFGl.png" alt=""></p><h2 id="bean-工厂与-bean-定义" tabindex="-1"><a class="header-anchor" href="#bean-工厂与-bean-定义"><span>Bean 工厂与 Bean 定义</span></a></h2><p><img src="https://image.itbaima.cn/markdown/2022/12/17/Un6qjPci2uvkL5X.png" alt=""></p><ul><li>三级缓存避免循环依赖 <ul><li>singletonObjects，用于保存实例化、注入、初始化完成的 bean 实例</li><li>earlySingletonObjects，用于保存实例化完成的 bean 实例</li><li>singletonFactories，在初始创建Bean对象时都会生成一个对应的单例工厂用于获取早期对象</li></ul></li></ul><p><img src="https://image.itbaima.cn/markdown/2022/12/18/xFfUuaozLpiVg96.png" alt=""></p><ul><li>[Bean定义]首先扫描Bean，加载Bean定义 -&gt; <strong>[Bean定义]Bean定义和Bean工厂后置处理</strong> -&gt; [依赖注入]根据Bean定义通过反射创建Bean实例 -&gt; [依赖注入]进行依赖注入（顺便解决循环依赖问题）-&gt; [初始化Bean]BeanPostProcessor的初始化之前方法 -&gt; [初始化Bean]Bean初始化方法 -&gt; [初始化Bean]BeanPostProcessor的初始化之前后方法 -&gt; [完成]最终得到的Bean加载完成的实例</li></ul><h2 id="bean-生命周期" tabindex="-1"><a class="header-anchor" href="#bean-生命周期"><span>Bean 生命周期</span></a></h2><ul><li>实例化-属性赋值-初始化-使用-销毁</li></ul><p><img src="https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-595fce5b-36cb-4dcb-b08c-8205a1e98d8a.png" alt=""></p><p><img src="https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-942a927a-86e4-4a01-8f52-9addd89642ff.png" alt=""></p><p><img src="https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-a3b7714e-38f2-433d-97c6-acb1d20f2887.png" alt=""></p><h2 id="springboot-启动原理" tabindex="-1"><a class="header-anchor" href="#springboot-启动原理"><span>SpringBoot 启动原理</span></a></h2><ul><li>服务构建-环境准备-容器创建-填充容器</li></ul><p><img src="https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-68744556-a1ba-4e1f-a092-1582875f0da6.png" alt=""></p>',17);function j(P,C){const e=o("ExternalLinkIcon");return p(),l("div",null,[u,c(" more "),d,n("ul",null,[n("li",null,[g,n("table",null,[m,n("tbody",null,[k,b,n("tr",null,[h,n("td",null,[a("同上，在"),n("a",v,[a("BeanFactory 和 ApplicationContext 的区别"),t(e)]),a(" 中已明确说明")])]),f,y,A])])]),B]),x,n("p",null,[n("a",_,[a("文档"),t(e)])]),w])}const R=i(r,[["render",j],["__file","spring.html.vue"]]),F=JSON.parse('{"path":"/posts/coding-related/spring/spring.html","title":"Spring 知识查缺补漏","lang":"zh-CN","frontmatter":{"title":"Spring 知识查缺补漏","icon":"fa-brands fa-java","date":"2024-01-12T00:00:00.000Z","category":["编程"],"tag":["Spring"],"head":[["meta",{"property":"og:url","content":"https://zjiac.github.io/tech-arch-doc/tech-arch-doc/posts/coding-related/spring/spring.html"}],["meta",{"property":"og:site_name","content":"zJiac 个人知识体系"}],["meta",{"property":"og:title","content":"Spring 知识查缺补漏"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://image.itbaima.cn/markdown/2022/11/22/sjLiFokU1f3CvH5.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-20T02:08:45.000Z"}],["meta",{"property":"article:author","content":"zJiaC"}],["meta",{"property":"article:tag","content":"Spring"}],["meta",{"property":"article:published_time","content":"2024-01-12T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-20T02:08:45.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Spring 知识查缺补漏\\",\\"image\\":[\\"https://image.itbaima.cn/markdown/2022/11/22/sjLiFokU1f3CvH5.png\\",\\"https://image.itbaima.cn/markdown/2022/12/17/C1RA4mBEoxNDFGl.png\\",\\"https://image.itbaima.cn/markdown/2022/12/17/Un6qjPci2uvkL5X.png\\",\\"https://image.itbaima.cn/markdown/2022/12/18/xFfUuaozLpiVg96.png\\",\\"https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-595fce5b-36cb-4dcb-b08c-8205a1e98d8a.png\\",\\"https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-942a927a-86e4-4a01-8f52-9addd89642ff.png\\",\\"https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-a3b7714e-38f2-433d-97c6-acb1d20f2887.png\\",\\"https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-68744556-a1ba-4e1f-a092-1582875f0da6.png\\"],\\"datePublished\\":\\"2024-01-12T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-20T02:08:45.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"zJiaC\\",\\"url\\":\\"https://zjiac.github.io/tech-arch-doc/\\"}]}"]]},"headers":[{"level":2,"title":"IOC","slug":"ioc","link":"#ioc","children":[]},{"level":2,"title":"Spring 高级特性","slug":"spring-高级特性","link":"#spring-高级特性","children":[]},{"level":2,"title":"SpringEL 表达式","slug":"springel-表达式","link":"#springel-表达式","children":[]},{"level":2,"title":"AOP","slug":"aop","link":"#aop","children":[]},{"level":2,"title":"事务","slug":"事务","link":"#事务","children":[]},{"level":2,"title":"Bean 工厂与 Bean 定义","slug":"bean-工厂与-bean-定义","link":"#bean-工厂与-bean-定义","children":[]},{"level":2,"title":"Bean 生命周期","slug":"bean-生命周期","link":"#bean-生命周期","children":[]},{"level":2,"title":"SpringBoot 启动原理","slug":"springboot-启动原理","link":"#springboot-启动原理","children":[]}],"git":{"createdTime":1705066954000,"updatedTime":1713578925000,"contributors":[{"name":"zJiaC","email":"425226133@qq.com","commits":5}]},"readingTime":{"minutes":4.33,"words":1299},"filePathRelative":"posts/coding-related/spring/spring.md","localizedDate":"2024年1月12日","excerpt":"\\n"}');export{R as comp,F as data};
